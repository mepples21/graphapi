Get-Content -Path ../

$tenantURL = "michaelepping.onmicrosoft.com"

$body = @{
    grant_type='client_credentials'
    client_id=""
    client_secret=""
    resource="https://graph.microsoft.com"
   }
   $contentType = 'application/x-www-form-urlencoded' 
   
   $authresult = "No Auth"
   $authresult = Invoke-RestMethod -Uri "https://login.microsoftonline.com/$tenantURL/oauth2/token" -Method 'Post' -Body $body -Headers $header -ContentType $contenttype

   do {
    Start-Sleep 3
} until ($authresult -ne "No Auth")

if($authResult.access_token){

    # Creating header for Authorization token
    $authHeader = @{
        'Authorization'="Bearer " + $authResult.access_token
        'Content-Type'='application/json'
        'ExpiresOn'=$authResult.expires_on
    }
}

else {
    Write-Host
    Write-Host "Authorization Access Token is null, please re-run authentication..." -ForegroundColor Red
    Write-Host
    break
}

